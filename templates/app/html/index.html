<!DOCTYPE HTML>
<html>
<head>
   <meta charset="utf-8" />
   <meta name="format-detection" content="telephone=no" />
   <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />

   <title>Dancing Bone Machine</title>

   <link rel="stylesheet" href="styles/styles.css" type="text/css" media="all" />

   <script src="scripts/dancing-bone-machine/dancing-bone-machine.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>

   <button id="btn" type="button">Beep.</button>
   <br/><button id="btnPicker" type="button">Choose a song from iTunes.</button>

   <script type="text/javascript" charset="utf-8">
      var sound_on = false;

      function button(e){
         // When the button is clicked, send a message to PD.
         if(sound_on){
            PD.sendFloat(0, 'volume');
            sound_on = false;
         }
         else{
            PD.sendFloat(1, 'volume');
            sound_on = true;
         }
      }

    function button2(e){
        PD.showMediaPicker(function(song){
            console.log(song.path);
            console.log(song.title);
            console.log(song.album);
            console.log(song.artist);
        },
        function(msg){
            console.log(msg);
        });
    }


      function main(){
         // Init PureData engine and load synth.pd patch.
         PD.configurePlayback(44100, 2, false, false, function(){
            PD.openFile('pd/patches', 'patch.pd', function(){
               PD.setActive(true);
               PD.sendFloat(0, 'volume');
            });
         });

         var btn = document.getElementById('btn');
         btn.onmouseup = button;
         btn.ontouchend = button;
         
         var btnPicker = document.getElementById('btnPicker');
         btnPicker.onmouseup = button2;
         btnPicker.ontouchend = button2;
    };
   </script>
</body>
</html>
